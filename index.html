<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Check-in Digital | Fila Cord</title>

<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;800&display=swap" rel="stylesheet">

<style>
:root {
    --primary: #6366f1;
    --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e1b4b 100%);
    --glass: rgba(255,255,255,.03);
    --glass-border: rgba(255,255,255,.1);
}

body {
    font-family: 'Plus Jakarta Sans', sans-serif;
    background: var(--bg-gradient);
    color: white;
    margin: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
}

.container { max-width: 450px; width: 100%; padding: 20px; }

.card {
    background: var(--glass);
    backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    border-radius: 32px;
    padding: 2.5rem;
}

.input-group { margin-bottom: 1.25rem; }

label {
    display: block;
    font-size: .85rem;
    font-weight: 600;
    margin-bottom: 8px;
    color: #cbd5e1;
}

input, select, textarea {
    width: 100%;
    padding: 14px 18px;
    background: rgba(15,23,42,.6);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    color: white;
}

button {
    width: 100%;
    padding: 18px;
    background: var(--primary);
    border: none;
    border-radius: 18px;
    color: white;
    font-weight: 700;
    cursor: pointer;
}

#sucesso { display:none; text-align:center; }

.senha-box {
    font-size: 4.5rem;
    font-weight: 800;
}
</style>
</head>

<body>

<div class="container">
<div class="card">

<div id="form-area">

<div class="input-group">
<label>NOME COMPLETO</label>
<input id="nome">
</div>

<div class="input-group">
<label>CPF</label>
<input id="cpf">
</div>

<div class="input-group">
<label>CURSO</label>
<select id="curso">
<option value="">Selecione...</option>
<option>Psicologia</option>
<option>Medicina</option>
<option>Direito</option>
<option>Administração</option>
<option>Outros</option>
</select>
</div>

<div class="input-group" id="grupo-responsavel" style="display:none">
<label>RESPONSÁVEL</label>
<select id="responsavel">
<option value="">Selecione...</option>
<option>Marcele</option>
<option>Emmanuelle</option>
<option>Leydiane</option>
</select>
</div>

<div class="input-group" id="grupo-assunto" style="display:none">
<label>ASSUNTO</label>
<select id="assunto">
<option value="">Selecione...</option>
<option>Dispensa</option>
<option>Internato</option>
<option>Dúvidas</option>
<option>Alocação</option>
<option>Salas</option>
<option>Falar com Coordenação</option>
<option>Outros</option>
</select>
</div>

<div class="input-group">
<label>TIPO DE ATENDIMENTO</label>
<select id="preferencial">
<option value="NAO">Normal</option>
<option value="SIM">Preferencial</option>
</select>
</div>

<div class="input-group">
<label>MOTIVO</label>
<textarea id="motivo"></textarea>
</div>

<button onclick="gerar()">GERAR SENHA</button>
</div>

<div id="sucesso">
<div class="senha-box" id="disp-senha">---</div>
<p>Aguarde ser chamado</p>
</div>

</div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const app = initializeApp({
    apiKey: "AIzaSyCMwHzsfQZIHsEqKlkIpQNTbZxCVYhFoZ8",
    projectId: "fila-cord"
});

const db = getFirestore(app);

curso.addEventListener("change", () => {
    const show = curso.value === "Medicina";
    grupo-responsavel.style.display = show ? "block" : "none";
    grupo-assunto.style.display = show ? "block" : "none";
});

window.gerar = async () => {
    const nome = nome.value.trim();
    const cpf = cpf.value.trim();
    const cursoVal = curso.value;
    const responsavel = responsavel?.value || "";
    const assunto = assunto?.value || "";
    const motivo = motivo.value.trim();
    const preferencial = preferencial.value;

    if (!nome || !cpf || !cursoVal || !motivo) {
        alert("Preencha todos os campos");
        return;
    }

    if (cursoVal === "Medicina" && (!responsavel || !assunto)) {
        alert("Selecione responsável e assunto");
        return;
    }

    const senha = (preferencial === "SIM" ? "P" : "A") + Math.floor(100 + Math.random() * 899);

    await addDoc(collection(db, "fila"), {
        nome, cpf, curso: cursoVal,
        responsavel, assunto, motivo,
        senha, preferencial,
        status: "ESPERA",
        hora: serverTimestamp()
    });

    document.getElementById("form-area").style.display = "none";
    document.getElementById("sucesso").style.display = "block";
    document.getElementById("disp-senha").innerText = senha;
};
</script>

</body>
</html>
